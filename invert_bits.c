/***********************************************************************************************************************
Includes
***********************************************************************************************************************/
#include "invert_bits.h"

/***********************************************************************************************************************
Internal functions
***********************************************************************************************************************/

/*!
************************************************************************************************************************
* @brief Checks if a 32-bit integer is a power of 2
************************************************************************************************************************
**/
bool isPowerOfTwo(int v)
{
    return v && !(v & (v - 1));
}

/*!
************************************************************************************************************************
* @brief Returns a rounded up number to the next highest power of 2
************************************************************************************************************************
**/
int roundUpNextPowerOfTwo(int v)
{
    v--;
    v |= v >> 1;
    v |= v >> 2;
    v |= v >> 4;
    v |= v >> 8;
    v |= v >> 16;
    v++;
    
    return v;
}

/*!
************************************************************************************************************************
* @brief Inverts actual (used) bits of a 32-bit integer number
************************************************************************************************************************
**/
int invertBits(int num)
{
    if((num == 0) || (isPowerOfTwo(num)))
    {
        return num - 1;
    }
    else
    {
        int mask = roundUpNextPowerOfTwo(num) - 1;
        return ((~num) & mask);
    }
}